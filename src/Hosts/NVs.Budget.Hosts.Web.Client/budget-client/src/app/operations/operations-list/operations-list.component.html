<div class="operations-container">
  <div tuiCardLarge class="operations-card">
    <div class="header">
      <h2 tuiTitle size="l">Operations</h2>
      <div class="header-actions">
        <button 
          tuiButton
          type="button"
          appearance="primary"
          size="m"
          (click)="navigateToImport()">
          Import Operations
        </button>
        <button 
          tuiButton
          type="button"
          appearance="destructive"
          size="m"
          (click)="navigateToDelete()">
          Delete Operations
        </button>
        <button 
          tuiButton
          type="button"
          appearance="secondary"
          size="m"
          (click)="navigateToBudget()">
          Back to Budget
        </button>
      </div>
    </div>

    <!-- Filters -->
    <form [formGroup]="filterForm" class="filters-section" (submit)="applyFilters(); $event.preventDefault()">
      <h3 tuiTitle size="m">Filters</h3>
      <div class="filters-grid">
        <div class="filter-item full-width">
          <tui-textfield>
            <label tuiLabel>Criteria Expression (Ctrl+Enter to apply)</label>
            <textarea 
              tuiTextarea 
              formControlName="criteria" 
              rows="2"
              placeholder="e.g., o => o.Amount.Amount > 100"
              (keydown)="onCriteriaKeydown($event)"
            ></textarea>
          </tui-textfield>
        </div>
        
        <div class="filter-item">
          <tui-textfield>
            <label tuiLabel>Output Currency</label>
            <input 
              tuiTextfield 
              formControlName="outputCurrency" 
              type="text" 
              placeholder="e.g., USD, EUR"
            />
          </tui-textfield>
        </div>
        
        <div class="filter-item checkbox-field">
          <label tuiLabel size="m">
            <input 
              tuiCheckbox
              type="checkbox" 
              formControlName="excludeTransfers"
            />
            Exclude Transfers
          </label>
        </div>
      </div>
      
      <div class="filter-actions">
        <button 
          tuiButton
          type="button"
          appearance="primary"
          size="s"
          (click)="applyFilters()">
          Apply Filters
        </button>
        <button 
          tuiButton
          type="button"
          appearance="flat"
          size="s"
          (click)="clearFilters()">
          Clear
        </button>
      </div>
    </form>

    <!-- Operations List -->
    <div class="operations-section">
      @if (operations$ | async; as ops) {
        @if (ops.length > 0) {
          <app-operations-table 
            [operations]="operations" 
            [showActions]="true"
            (operationDeleted)="onDeleteOperation($event)">
          </app-operations-table>
          
          <div class="operations-count">
            Total: {{ operations.length }} operations
          </div>
        } @else {
          <div class="empty-state">
            <p>No operations found.</p>
            <button 
              tuiButton
              type="button"
              appearance="primary"
              size="m"
              (click)="navigateToImport()">
              Import Operations
            </button>
          </div>
        }
      } @else {
        <tui-loader [showLoader]="true">
          <div class="loading-placeholder">Loading operations...</div>
        </tui-loader>
      }
    </div>
  </div>
</div>

