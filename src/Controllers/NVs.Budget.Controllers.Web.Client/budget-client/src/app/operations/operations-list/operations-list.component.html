<div class="operations-container">
  <div tuiCardLarge class="operations-card">
    <div class="header">
      <h2 tuiTitle size="l">Operations</h2>
      <div class="header-actions">
        <button
          tuiButton
          type="button"
          appearance="primary"
          size="m"
          (click)="navigateToLogbook()">
          View Logbook
        </button>
        <button
          tuiButton
          type="button"
          appearance="secondary"
          size="m"
          (click)="navigateToTransfers()">
          View Transfers
        </button>
        <button
          tuiButton
          type="button"
          appearance="secondary"
          size="m"
          (click)="navigateToDuplicates()">
          View Duplicates
        </button>
        <button
          tuiButton
          type="button"
          appearance="secondary"
          size="m"
          (click)="navigateToRetag()">
          Retag Operations
        </button>

        <button
          tuiButton
          type="button"
          appearance="primary"
          size="m"
          (click)="navigateToImport()">
          Import Operations
        </button>

        <button
          tuiButton
          type="button"
          appearance="destructive"
          size="m"
          (click)="navigateToDelete()">
          Delete Operations
        </button>
        <button
          tuiButton
          type="button"
          appearance="secondary"
          size="m"
          (click)="navigateToBudget()">
          Budget Details
        </button>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters-section">
      <app-criteria-filter
        [initialCriteria]="currentCriteria"
        [showExamplesInitially]="false"
        (criteriaSubmitted)="onCriteriaSubmitted($event)"
        (criteriaCleared)="onCriteriaCleared()">

            <tui-textfield tuiChevron class="currency-selector">
              <input
                tuiSelect
                placeholder="Output Currency"
                tuiTextfieldSize="s"
                [(ngModel)]="outputCurrency"
              />
              <tui-data-list-wrapper
                *tuiTextfieldDropdown
                new
                [items]="items"
              />
            </tui-textfield>

            <label tuiLabel size="m">
              <input
                tuiCheckbox
                type="checkbox"
                [(ngModel)]="excludeTransfers"
              />
              Exclude Transfers
            </label>
      </app-criteria-filter>
    </div>

    <!-- Operations List -->
    <div class="operations-section">
      @if (operations$ | async; as ops) {
        @if (ops.length > 0) {
          <app-operations-table
            [operations]="operations"
            [showActions]="true"
            (operationsDeleted)="onDeleteOperations($event)"
            (operationsUpdated)="onUpdateOperations($event)"
            (operationNoteUpdated)="onUpdateOperationNote($event)">
          </app-operations-table>

          <div class="operations-count">
            Total: {{ operations.length }} operations
          </div>
        } @else {
          <div class="empty-state">
            <p>No operations found.</p>
            <button
              tuiButton
              type="button"
              appearance="primary"
              size="m"
              (click)="navigateToImport()">
              Import Operations
            </button>
          </div>
        }
      } @else {
        <tui-loader [showLoader]="true">
          <div class="loading-placeholder">Loading operations...</div>
        </tui-loader>
      }
    </div>
  </div>
</div>
